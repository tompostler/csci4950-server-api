<!DOCTYPE html>
<html>
<head>
    <title>API Reference</title>
</head>
<body>

<xmp style="display:none;" toc>
# Overview and Basic Features

This section gives you an overview of how to use the API as well as what types of requests you can
make against the API.




## Request URL Format

In order to make a request of any type, the request URL must be a standard HTTP URL structured as
such:

    http://HOST/api/ROOTNODE[/SUBNODE][?PARAM1=VALUE1][&PARAM2=VALUE2][&PARAM3=VALUE3]...

Where:

Item | Description
:---: | :---
`HOST` | The hostname that is hosting the API. Right now, that would be `ralphie.cloudapp.net`
`ROOTNODE` | The root node on the API. This is elaborated on in the [root nodes](#root-nodes) section.
`[/SUBNODE]` | If using a `PUT` or `DELETE`, then this is a shortcut used to handle one item.
`[?PARAM1=VALUE1]` | If you wish/need to supply parameters to the URL for the request type you are using, then those start after the root node URL with a `?` and then a `key=value` system.
`[&PARAM2=VALUE2]` | Any subsequent or additional parameters that you wish/need to define for the specific HTTP URL will continue in `key=value` format and are separated from other parameters with a `&`.




## Request Types

There are four types of requests you can make against the server, each of which performs a different
action detailed below:

* `GET`
* `PUT`
* `POST`
* `DELETE`

Requests will always have a status code representing what happend, with optionally including JSON.

To send data with a request, the HTTP header `Content-Type` must be `application/json` if you are
sending JSON in the request body. You will receive an error otherwise.



### GET Requests

These are used to request data from the server in a read-only style.

All parameters that you wish to supply are passed to the API via URL parameters. For example, if you
wish to ask for the activity associated with user ID 7 and category 4, then the URL string you would
use is:

    http://ralphie.cloudapp.net/api/activities?user=7&category=4



### PUT Requests

These are used when updating an existing item on the server.

All parameters are passed via JSON in a `PUT` request to the appropriate root node with the id to
update as a subnode. For example, if you wish to update the activity with ID of 1, then you would
send a `PUT` request with a JSON body of information to update to the URL string:

    ralphie.cloudapp.net/api/activities/1

You must send the entire item (as if you were doing a `POST` request) to the server.



### POST Requests

These are used when creating a new item on the server.

All parameters are passed via JSON in a `POST` request to the appropriate root node. For example, if
you wanted to create a new activity, then you would send a `POST` request with a JSON body of
information to the URL string:

    tneunreals-t03.cloudapp.net/api/activities



### DELETE Requests

These are used when deleting an existing item on the server.

No parameters are necessary. Simply send a `DELETE` request to the appropriate root node with the id
to delete as a subnode. For example, if you wish to delete the activity with ID of 1, then you would
send a `DELETE` request to the URL string:

    ralphie.cloudapp.net/api/activities/1

Deleting an item that is depended upon by other items (such as deleting a user) will cascade the
deletion to delete all dependencies.




## Response Types

There are different responses for each type of request sent to the server.

__Notes:__
    
- In all cases below, if there is no valid match to the query or action, then a status of `404 Not
Found` is returned to the caller, regardless of what it says are possible return results.
- In all cases below, if some action causes an error, then a generic status of `400 Bad Request` is
returned to the caller, regardless of what it says are possible return results.



### GET Requests

When any `GET` requests are issued with an ID specified, the result will be the one corresponding
item with a `200 OK` status.

All other `GET` requests will return a list containing one or more matching items with a `200 OK`
status.



### PUT Requests

Upon successful `PUT`, will return the updated data with a `200 OK` status.

This may be changed to return a `204 No Content` status on a successful `PUT` in the future. This
will be determined by the volume of complaints from you guys.



### POST Requests

Upon successful `POST` will return the new item with a `201 Created` status and the `Location`
header set to a link for the new item.



### DELETE Requests

Upon successful `DELETE`, will return a `200 OK` status.


----------------------------------------------------------------------------------------------------


# Nodes

There are currently 5 root nodes, each with several optional and/or required subnodes for basic
`GET` querying (along with `PUT` and `POST` operations).




## Root Nodes

Node | Description
:--- | :---
[`/activities`](#activities-node) | Corresponds to an activity.
[`/activity_units`](#activity_units-node) | Corresponds to an activity work unit.
[`/locations`](#locations-node) | Corresponds to a location.
[`/tags`](#tags-node) | Corresponds to a user-defined tag.
[`/users`](#users-node) | Corresponds to a user.

For `GET` requests, the root level nodes will return __all__ entries in the database corresponding
to that node. This is a _very_ expensive operation, and will be removed as a "feature" once we have
moved from the development phase into the beta testing phase.

For `PUT` and `DELETE` requests, this will need to be coupled with a [subnode](#subnodes) for proper
usage.

For `POST` requests, this is all the information you need since all data to `POST` will be in the
body of your request.

The following descriptions of the parameters on the nodes are used in the URL parameters of `GET`
requests and the bodies of `PUT` and `POST` requests.



### activities Node

Parameter | Description
:--- | :---
`id` | An integer ID uniquely identifying the activity. This is automatically incremented on creation of a new activity.
`user_id` | An integer correlating to an existing user ID. This will link an activity to a specific user.
`name` | A maximum 50-character string for the user-defined name of an activity.
`category` | A tinyint (range -128 to 127) matching one of the predefined categories. The categories are TBD, but will be linked from here in the future.
`tag_ids` | A list of integers correlating to existing tag IDs.



### activity_units Node

There are two forms of the API available for `activity_units`. The first is as follows and supports
the expected requests:

Parameter | Description
:--- | :---
`id` | An integer ID uniquely identifying the activity work unit. This is automatically incremented on creation of a new activity work unit.
`activity_id` | An integer correlating to an existing activity ID. This will link an activity work unit to a specific activity.
`location_id` | An integer correlating to an existing location ID. This will link an activity work unit to a specific location.
`stime` | The start date and time of the activity work unit, in [UTC format](#date-time-formats).
`etime` | The end date and time of the activity work unit, in [UTC format](#date-time-formats).
`tag_ids` | A list of integers correlating to existing tag IDs.

The other form of the API is strictly for `GET` requests. It allows querying of date ranges to
return activity work units. (Hint: This may be useful for building a calendar day of events rapidly)

Parameter | Required? | Description
:--- | :---: | :---
`btime` | Yes | The beginning of the range for the date and time to search, in [UTC format](#date-time-formats).
`etime` | Yes | The end of the range for the date and time to search, in [UTC format](#date-time-formats).
`activity` | No | An integer correlating to an existing activity ID. This will link an activity work unit to a specific activity.
`location` | No | An integer correlating to an existing location ID. This will link an activity work unit to a specific location.

For example, if I wanted to find all activity work units corresponding to an activity with ID of 7
that occurred on February 19th (in CST), then I would use the following HTTP `GET` request to ask
for all activity units that started sometime on Feb 19 and ended sometime on Feb 19 with activity ID
of 7:

    ralphie.cloudapp.net/api/activity_units?activity=7&btime=2014-02-19T06:00:00Z&etime=2014-02-20T06:00:00Z



### locations Node

Parameter | Description
:--- | :---
`id` | An integer uniquely identifying the location. This is automatically incremented on creation of a new location.
`user_id` | An integer correlating to an existing user ID. This will link a location to a specific user.
`name` | A maximum 50-character string for the user-defined (or potentially suggested) name of a location.
`type` | A tinyint (range -128 to 127) matching one of the predefined location types. The types are TBD, but will be linked from here in the future.
`content` | A maximum 100-character string for storing location data. This can be a lat-long, an address, or whatever.



### tags Node

Parameter | Description
:--- | :---
`id` | An integer uniquely identifying the tag. This is automatically incremented on creation of a new tag.
`user_id` | An integer correlating to an existing user ID. This will link a tag to a specific user.
`name` | A maximum 20-character string for the user-defined (or potentially suggested) name of a tag.
`description` | A maximum 100-character string for storing the user-defined (or potentially suggested) description of a tag.
`color` | A maximum 6-character string for storing color data. This should be represented in hex, but this is currently not verified server-side.



### users Node

Parameter | Description
:--- | :---
`id` | An integer uniquely identifying the user. This is automatically incremented on creation of a new user.
`fname` | A maximum 50-character string for the user's first name.
`lname` | A maximum 50-character string for the user's last name.
`email` | A maximum 50-character string for the user's email. __Uniqueness of the email is not enforced by the API.__
`password` | A maximum 50-character string for the user's password. This is currently stored in the wonderfullness of plaintext. See [the notes](#password-storage) on this for more info.

Of the above parameters, `GET` requests only support querying by `id` and `email`.
    
If you wish to issue `GET` queries for `fname`, `lname`, or `password`, then we suggest you
think about what you are doing and decide not to do it instead.




## Subnodes

For any request type (not including `GET` requests), an ID can be used to work with one item of the
corresponding type from a root node.

For `PUT` and `DELETE` requests, this format is necessary to work with only one item at a time.

The URL format for working with a subnode is:

    http://ralphie.cloudapp.net/api/ROOTNODE/SUBNODE


----------------------------------------------------------------------------------------------------


# Examples

TBW (To Be Written)

Languages to write examples for:

- JavaScript


----------------------------------------------------------------------------------------------------


# Notes

Random notes and things that don't have a better place in this documentation.



### API Security

This API is currently completely public with no authentication, verification, encryption,
obfuscation, or logging whatsoever.

This will be our next feature target as soon as this API is determined to be stable and good enough
for the rest of the team.

We are researching the best way to implement security in a non-intrusive manner.

Setting up HTTPS sucks, but that is our first step. HTTP requests will not be accepted (if this is
possible).



### Password Storage

Ideally, a user's password will be salted and hashed before being sent to the server and then the
server will salt and hash the password again so that no part of the chain knows the password and it
is incredibly difficult to guess.

Or we just support logging in with Google/Facebook/Twitter/etc and we at the API store the OAuth
token for you.

In the meantime for the wonderfullness that is quick-and-dirty, we are using plaintext storage on
the API for passwords capped at 50 characters. How the client handles passwords handed to the API
will be treated as an [SEP](http://en.wikipedia.org/wiki/Somebody_Else%27s_Problem#Fiction).



### Date/Time Formats

Any Date/Time formats that are passed in or received via the URL or in JSON bodies will be
represented by the standard UTC format of `yyyy-mm-ddThh:mm:ssZ`.
    
For example, February 18th, 2014 at 9:25:07 PM CST would translate to `2015-02-19T03:25:07Z` (with
Daylight Savings Time not in effect on that date, CST is 6 hours behind UTC).
</xmp>

    <script src="http://ndossougbe.github.io/strapdown/dist/strapdown.js"></script>
</body>
</html>
