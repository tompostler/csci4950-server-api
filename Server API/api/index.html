<!DOCTYPE html>
<html>
<head>
    <title>API Reference</title>
</head>
<body>

<xmp style="display:none;" toc>
# Overview and Basic Features

This section gives you an overview of how to use the API as well as what types of requests you can
make against the API.




## Request URL Format

In order to make a request of any type, the request URL must be a standard HTTP URL structured as
such:

    HOST/api/ROOTNODE[/SUBNODE][?PARAM1=VALUE1][&PARAM2=VALUE2][&PARAM3=VALUE3]...

Where:

Item | Description
:---: | :---
`HOST` | The hostname that is hosting the API. Right now, that would be `ralphie.cloudapp.net`
`ROOTNODE` | The root node on the API. This is elaborated on in the [root nodes](#root-nodes) section.
`[/SUBNODE]` | If using a `PUT` or `DELETE`, then this is a shortcut used to handle one item.
`[?PARAM1=VALUE1]` | If you wish/need to supply parameters to the URL for the request type you are using, then those start after the root node URL with a `?` and then a `key=value` system.
`[&PARAM2=VALUE2]` | Any subsequent or additional parameters that you wish/need to define for the specific HTTP URL will continue in `key=value` format and are separated from other parameters with a `&`.




## Request Types

There are four types of requests you can make against the server, each of which performs a different
action detailed below:

* `GET`
* `PUT`
* `POST`
* `DELETE`

Requests will generally return data in a JSON format representing one thing or another.

To send data with a request, the HTTP header `Content-Type` must be `application/json` if you are
sending JSON in the request body. You will receive an error otherwise.



### GET Requests

These are used to request data from the server in a read-only style.

All parameters that you wish to supply are passed to the API via URL parameters. For example, if you
wish to ask for the activity associated with user ID 7 and category 4, then the URL string you would
use is:

    ralphie.cloudapp.net/api/activities?user=7&category=4


#### Response

When querying using the regular parameters, the result will always be a JSON list of results that
will contain 0 or more items serialized into an appropriate JSON format.



### PUT Requests

These are used when updating an existing item on the server.

All parameters are passed via JSON in a `PUT` request to the appropriate root node with the id to
update as a subnode. For example, if you wish to update the activity with ID of 1, then you would
send a `PUT` request with a JSON body of information to update to the URL string:

    ralphie.cloudapp.net/api/activities/1

You must send the entire item (as if you were doing a `POST` request) to the server.


#### Response

When using a `PUT` request, the response will always be a JSON object with one boolean element
indicating success or failure:

    {
        "success": true
    }



### POST Requests

These are used when creating a new item on the server.

All parameters are passed via JSON in a `POST` request to the appropriate root node. For example, if
you wanted to create a new activity, then you would send a `POST` request with a JSON body of
information to the URL string:

    tneunreals-t03.cloudapp.net/api/activities


#### Response

When using a `POST` request, the response will always be a JSON object with one boolean element
indicating success or failure, one optional numeric element with the created ID of the object, and
one optional element detailing the errors associated with an unsuccessful `POST`:

    {
        "success": true,
        "id": 1234
    }

Or:

    {
        "success": false
        "description":
            TODO - Works but needs cleaning up
    }



### DELETE Requests

These are used when deleting an existing item on the server.

No parameters are necessary. Simply send a `DELETE` request to the appropriate root node with the id
to delete as a subnode. For example, if you wish to delete the activity with ID of 1, then you would
send a `DELETE` request to the URL string:

    ralphie.cloudapp.net/api/activities/1

Deleting an item that is depended upon by other items (such as deleting a user) will cascade the
deletion to delete all dependencies.


#### Response

When using a `DELETE` request, the response will always be a JSON object with one boolean element
indicating success or failure:

    {
        "success": true
    }


----------------------------------------------------------------------------------------------------


# Nodes

There are currently 4 root nodes, each with several optional and/or required subnodes for basic GET
querying.




## Root Nodes

Node | Description
:--- | :---
[`/activities`](#activities-node) | Corresponds to an activity.
[`/activity_units`](#activity_units-node) | Corresponds to an activity work unit.
[`/locations`](#locations-node) | Corresponds to a location.
[`/users`](#users-node) | Corresponds to a user.

For `GET` requests, the root level nodes will return __all__ entries in the database corresponding
to that node. This is a _very_ expensive operation, and will be removed as a feature once we have
moved from the development phase into the beta testing phase.

For `PUT` and `DELETE` requests, this will need to be coupled with a [subnode](#subnodes) for proper
usage.

For `POST` requests, this is all the information you need since all data to `POST` will be in the
JSON body of your request.

The following descriptions of the parameters on the nodes are used in the URL parameters of `GET`
requests and the JSON bodies of `PUT` and `POST` requests.



### activities Node

Parameter | Description
:--- | :---
`id` | An integer ID uniquely identifying the activity. This is automatically incremented on creation of a new activity.
`user` | An integer correlating to an existing user ID. This will link an activity to a specific user.
`name` | A maximum 50-character string for the user-defined name of an activity.
`category` | A tinyint (range -128 to 127) matching one of the predefined categories. The categories are TBD, but will be linked from here in the future.



### activity_units Node

There are two forms of the API available for `activity_units`. The first is as follows and supports
the expected requests:

Parameter | Description
:--- | :---
`id` | An integer ID uniquely identifying the activity work unit. This is automatically incremented on creation of a new activity work unit.
`activity` | An integer correlating to an existing activity ID. This will link an activity work unit to a specific activity.
`location` | An integer correlating to an existing location ID. This will link an activity work unit to a specific location.
`startTime` | The start date and time of the activity work unit, in [UTC format](#date-time-formats).
`endTime` | The end date and time of the activity work unit, in [UTC format](#date-time-formats).

The other form of the API is strictly for `GET` requests. It allows querying of date ranges to
return activity work units. (Hint: This may be useful for building a calendar day of events rapidly)

Parameter | Required? | Description
:--- | :---: | :---
`startTimeBeg` | Yes | The beginning of the range for the start date and time to search, in [UTC format](#date-time-formats).
`startTimeEnd` | Yes | The end of the range for the start date and time to search, in [UTC format](#date-time-formats).
`endTimeBeg` | Yes | The beginning of the range for the end date and time to search, in [UTC format](#date-time-formats).
`endTimeEnd` | Yes | The end of the range for the end date and time to search, in [UTC format](#date-time-formats).
`activity` | No | An integer correlating to an existing activity ID. This will link an activity work unit to a specific activity.
`location` | No | An integer correlating to an existing location ID. This will link an activity work unit to a specific location.

For example, if I wanted to find all activity work units corresponding to an activity with ID of 7
that occurred on February 19th (in CST), then I would use the following URL `GET` request to ask for
all activities that started sometime on Feb 19 and ended some time on Feb 19 with activity ID of 7:

    ralphie.cloudapp.net/api/activity_units?activity=7&startTimeBeg=2014-02-19T06:00:00Z&startTimeEnd=2014-02-20T06:00:00Z&endTimeBeg=2014-02-19T06:00:00Z&endTimeEnd=2014-02-20T06:00:00Z



### locations Node

Parameter | Description
:--- | :---
`id` | An integer uniquely identifying the location. This is automatically incremented on creation of a new location.
`user` | An integer correlating to an existing user ID. This will link a location to a specific user.
`name` | A maximum 50-character string for the user-defined (or potentially suggested) name of a location.
`type` | A tinyint (range -128 to 127) matching one of the predefined location types. The types are TBD, but will be linked from here in the future.
`content` | A maximum 100-character string for storing location data. This can be a lat-long, an address, or whatever.



### users Node

Parameter | Description
:--- | :---
`id` | An integer uniquely identifying the user. This is automatically incremented on creation of a new user.
`fname` | A maximum 50-character string for the user's first name.
`lname` | A maximum 50-character string for the user's last name.
`email` | A maximum 50-character string for the user's email. __Uniqueness of the email is not enforced by the API.__
`password` | A maximum 50-character string for the user's password. This is currently stored in the wonderfullness of plaintext. See [the notes](#password-storage) on this for more info.

Of the above parameters, `GET` requests only support querying by `id` and `email`.
    
If you wish to issue `GET` queries for `fname`, `lname`, or `password`, then we suggest you
think about what you're doing and decide not to do it instead.

If 50 characters are not deemed enough, this limit can be upped quite painlessly with a request to
Anthony or Tom.




## Subnodes

For any request type (not including `GET` requests), an ID can be used to work with one item of the
corresponding type from a root node.

For `PUT` and `DELETE` requests, this format is necessary to work with only one object at a time.

The URL format for working with a subnode is:

    ralphie.cloudapp.net/api/ROOTNODE/SUBNODE


----------------------------------------------------------------------------------------------------


# Notes

Random notes and things that don't have a better place in this documentation.



### API Security

This API is currently completely public with no authentication, verification, encryption,
obfuscation, or logging whatsoever.

This will be our next feature target as soon as this API is determined to be stable and good enough
for the rest of the team.

We are researching the best way to implement security in a non-intrusive manner.



### Password Storage

Ideally, a user's password will be salted and hashed before being sent to the server and then the
server will salt and hash the password again so that no part of the chain knows the password and it
is incredibly difficult to guess.

Or we just support logging in with Google/Facebook/Twitter/etc.

In the meantime for the wonderfullness that is quick-and-dirty, we are using plaintext storage on
the API for passwords capped at 50 characters. How the client handles passwords handed to the API
will be treated as an [SEP](http://en.wikipedia.org/wiki/Somebody_Else%27s_Problem#Fiction).



### Date/Time Formats

Any Date/Time formats that are passed in or received via the URL or in JSON bodies will be
represented by the standard UTC format of `yyyy-mm-ddThh:mm:ssZ`.
    
For example, February 18th, 2014 at 9:25:07 PM CST would translate to `2015-02-19T03:25:07Z` (with
Daylight Savings Time not in effect on that date, CST is 6 hours behind UTC).
</xmp>

    <script src="http://ndossougbe.github.io/strapdown/dist/strapdown.js"></script>
</body>
</html>
